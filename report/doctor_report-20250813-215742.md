# Contract AI — Doctor Report v2

**PASS:** 11  **WARN:** 2  **FAIL:** 3

## Chain view (end‑to‑end)
- **Word ➜ Taskpane UI** — depends on FRONT:Manifest/Taskpane checks
- **Taskpane fetch ➜ Backend** — depends on NET:Health/CORS + API:POST /api/analyze
- **Backend router ➜ Pipeline** — see PIPELINE check
- **Pipeline ➜ Rules** — see RULES discovery & Rule run checks
- **Backend ➜ JSON** — see API invariants
- **Taskpane ➜ Render** — FRONT:Taskpane containers + renderAnalysis() present

## Checks
| Status | Section | Check | Details |
|---|---|---|---|
| ✅ PASS | **FRONT** | Manifest SourceLocation | url=https://localhost:3000/app/build-20250813-2157/taskpane.html cache_bust=no hosts=Document |
| ✅ PASS | **FRONT** | Taskpane files | exists=True containers-missing=[] render_fn=ok backend_hint=https://localhost:9000 |
| ⚠️ WARN | **NET** | TLS certificate | cert error: ConnectionRefusedError(10061, 'Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение', None, 10061, None) |
| ❌ FAIL | **NET** | Health endpoint |  ConnectionError(MaxRetryError("HTTPSConnectionPool(host='localhost', port=9000): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000002725E63D400>: Failed to establish a new connection: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение'))")) (4080 ms) |
| ❌ FAIL | **NET** | CORS preflight | status=0 allow-origin=None (4107 ms) |
| ❌ FAIL | **API** | POST /api/analyze | http=0 inv=ok ConnectionError(MaxRetryError("HTTPSConnectionPool(host='localhost', port=9000): Max retries exceeded with url: /api/analyze (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000002725E66DD10>: Failed to establish a new connection: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение'))")) (4107 ms) |
| ⚠️ WARN | **API** | Trace by CID | 0 ConnectionError(MaxRetryError("HTTPSConnectionPool(host='localhost', port=9000): Max retries exceeded with url: /api/trace/cid-1755118675 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000002725E66DF90>: Failed to establish a new connection: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение'))")) (4103 ms) |
| ✅ PASS | **RULES** | Rules discovery | 7 module(s) in pipeline.discover_rules |
| ✅ PASS | **RULES** | Rule run: confidentiality | status=FAIL find=12 |
| ✅ PASS | **RULES** | Rule run: force_majeure | status=FAIL find=1 |
| ✅ PASS | **RULES** | Rule run: governing_law | status=OK find=0 |
| ✅ PASS | **RULES** | Rule run: indemnity | status=FAIL find=8 |
| ✅ PASS | **RULES** | Rule run: jurisdiction | status=OK find=0 |
| ✅ PASS | **RULES** | Rule run: termination | status=FAIL find=2 |
| ✅ PASS | **RULES** | Rule run: legal_rules | status=WARN find=1 |
| ✅ PASS | **PIPELINE** | pipeline.analyze_document | results=['confidentiality'] |

## Hints
- If **NET/Health** fails → backend is not listening or TLS mismatch.
- If **NET/CORS** warns → check CORSMiddleware allow_origins for http/https localhost:3000.
- If **API invariants** fail → shape mismatch: ensure /api/analyze returns findings/recommendations.
- If **RULES run** fails for a rule → examine that module's `analyze()` and return dict/Pydantic with `.model_dump()`.
- If **FRONT/Taskpane** fails → ensure `taskpane.html` has containers (resClauseType, findingsList, recsList, rawJson) and JS has `renderAnalysis()`.
- Use **CID** header (`x-cid`) in panel fetch and GET `/api/trace/{cid}` for server-side trace (if middleware present).